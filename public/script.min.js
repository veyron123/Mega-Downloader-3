function updateThumbnail(e,t){let n=e.querySelector(".drop-zone__thumb");if(e.querySelector(".drop-zone__prompt")&&e.querySelector(".drop-zone__prompt").remove(),n||(n=document.createElement("div"),n.classList.add("drop-zone__thumb"),e.appendChild(n)),n.dataset.label=t.name,t.type.startsWith("image/")){const e=new FileReader;e.readAsDataURL(t),e.onload=()=>{n.style.backgroundImage=`url('${e.result}')`}}else n.style.backgroundImage=null}document.querySelectorAll(".drop-zone__input").forEach(e=>{const t=e.closest(".drop-zone");t.addEventListener("click",t=>{e.click()}),e.addEventListener("change",n=>{e.files.length&&updateThumbnail(t,e.files[0])}),t.addEventListener("dragover",e=>{e.preventDefault(),t.classList.add("drop-zone--over")}),["dragleave","dragend"].forEach(e=>{t.addEventListener(e,e=>{t.classList.remove("drop-zone--over")})}),t.addEventListener("drop",n=>{n.preventDefault(),n.dataTransfer.files.length&&(e.files=n.dataTransfer.files,updateThumbnail(t,n.dataTransfer.files[0])),t.classList.remove("drop-zone--over")})});const uploadBtn=document.getElementById("upload-btn"),urlBtn=document.getElementById("url-btn"),localResult=document.getElementById("local-result"),urlResult=document.getElementById("url-result"),fileInput=document.querySelector(".drop-zone__input"),urlInput=document.getElementById("url-input");uploadBtn.addEventListener("click",async()=>{if(!fileInput.files.length)return void(localResult.textContent="Пожалуйста, выберите файл.");const e=fileInput.files[0],t=new FormData;t.append("file",e),localResult.textContent="Загрузка и транскрипция...";try{const e=await fetch("/transcribe-file",{method:"POST",body:t}),n=await e.json();e.ok?localResult.textContent=n.transcription:localResult.textContent=`Ошибка: ${n.error}`}catch(e){localResult.textContent=`Ошибка сети: ${e.message}`}}),urlBtn.addEventListener("click",async()=>{const e=urlInput.value;if(e){urlResult.textContent="Загрузка и транскрипция...";try{const t=await fetch("/transcribe-url",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e})}),n=await t.json();t.ok?urlResult.textContent=n.transcription:urlResult.textContent=`Ошибка: ${n.error}`}catch(e){urlResult.textContent=`Ошибка сети: ${e.message}`}}else urlResult.textContent="Пожалуйста, введите URL."});